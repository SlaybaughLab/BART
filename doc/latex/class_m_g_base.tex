\hypertarget{class_m_g_base}{}\section{M\+G\+Base$<$ dim $>$ Class Template Reference}
\label{class_m_g_base}\index{M\+G\+Base$<$ dim $>$@{M\+G\+Base$<$ dim $>$}}


This class provides abstract functionalities for MG calculations.  




{\ttfamily \#include $<$mg\+\_\+base.\+h$>$}



Inheritance diagram for M\+G\+Base$<$ dim $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=189pt]{class_m_g_base__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for M\+G\+Base$<$ dim $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=189pt]{class_m_g_base__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_m_g_base_ad938184229e773a339be9ba1fc487aa1}{M\+G\+Base} (const Parameter\+Handler \&prm)
\item 
virtual \hyperlink{class_m_g_base_a011e50e1caf44cfa3335b95d161ba14d}{$\sim$\+M\+G\+Base} ()
\begin{DoxyCompactList}\small\item\em A virtual destructor for M\+G\+Base. \end{DoxyCompactList}\item 
virtual void \hyperlink{class_m_g_base_a3586c47d901608bc42792c6de456b1cb}{do\+\_\+iterations} (std\+::vector$<$ Vector$<$ double $>$ $>$ \&sflxes\+\_\+proc, std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&equ\+\_\+ptrs, std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$ ig\+\_\+ptr)
\item 
virtual void \hyperlink{class_m_g_base_a6ae523b6ee434588d85f8370413d0de9}{mg\+\_\+iterations} (std\+::vector$<$ Vector$<$ double $>$ $>$ \&sflxes\+\_\+proc, std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&equ\+\_\+ptrs, std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$ ig\+\_\+ptr)
\item 
virtual void \hyperlink{class_m_g_base_a55ba9bef3616dd5eab9e3986f6e8e311}{nonthermal\+\_\+solves} (std\+::vector$<$ Vector$<$ double $>$ $>$ \&sflxes\+\_\+proc, std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&equ\+\_\+ptrs, std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$ ig\+\_\+ptr)
\item 
virtual void \hyperlink{class_m_g_base_a9d3c6ab6e58f0119badb30feedb2ac4d}{thermal\+\_\+iterations} (std\+::vector$<$ Vector$<$ double $>$ $>$ \&sflxes\+\_\+proc, std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&equ\+\_\+ptrs, std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$ ig\+\_\+ptr)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
unsigned int \hyperlink{class_m_g_base_a7df1f6ce51cf6eb033420be98b1f0019}{g\+\_\+thermal}
\begin{DoxyCompactList}\small\item\em Starting group index where upscattering exists. \end{DoxyCompactList}\item 
const double \hyperlink{class_m_g_base_af50b1bdc92270c342524eacfc644170c}{err\+\_\+phi\+\_\+tol}
\begin{DoxyCompactList}\small\item\em Multigroup iteration tolerance for convergence check. \end{DoxyCompactList}\item 
std\+::vector$<$ Vector$<$ double $>$ $>$ \hyperlink{class_m_g_base_ad8a9d4163bb31470fff74fe787c23788}{sflxes\+\_\+proc\+\_\+prev\+\_\+mg}
\begin{DoxyCompactList}\small\item\em A scalar flux vector recording the old sflxes\+\_\+proc. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\subsubsection*{template$<$int dim$>$\newline
class M\+G\+Base$<$ dim $>$}

This class provides abstract functionalities for MG calculations. 

This class serves as the base class of MG iterations. It inherits from Iteration\+Base.

\begin{DoxyAuthor}{Author}
Weixiong Zheng 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2017/08 
\end{DoxyDate}


Definition at line 18 of file mg\+\_\+base.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_m_g_base_ad938184229e773a339be9ba1fc487aa1}\label{class_m_g_base_ad938184229e773a339be9ba1fc487aa1}} 
\index{M\+G\+Base@{M\+G\+Base}!M\+G\+Base@{M\+G\+Base}}
\index{M\+G\+Base@{M\+G\+Base}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{M\+G\+Base()}{MGBase()}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
\hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::\hyperlink{class_m_g_base}{M\+G\+Base} (\begin{DoxyParamCaption}\item[{const Parameter\+Handler \&}]{prm }\end{DoxyParamCaption})}

A constructor of M\+G\+Base.


\begin{DoxyParams}{Parameters}
{\em prm} & A Parameter\+Handler object containing all the parameters needed. \\
\hline
\end{DoxyParams}


Definition at line 4 of file mg\+\_\+base.\+cc.

\mbox{\Hypertarget{class_m_g_base_a011e50e1caf44cfa3335b95d161ba14d}\label{class_m_g_base_a011e50e1caf44cfa3335b95d161ba14d}} 
\index{M\+G\+Base@{M\+G\+Base}!````~M\+G\+Base@{$\sim$\+M\+G\+Base}}
\index{````~M\+G\+Base@{$\sim$\+M\+G\+Base}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{$\sim$\+M\+G\+Base()}{~MGBase()}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
\hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::$\sim$\hyperlink{class_m_g_base}{M\+G\+Base} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



A virtual destructor for M\+G\+Base. 



Definition at line 18 of file mg\+\_\+base.\+cc.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_m_g_base_a3586c47d901608bc42792c6de456b1cb}\label{class_m_g_base_a3586c47d901608bc42792c6de456b1cb}} 
\index{M\+G\+Base@{M\+G\+Base}!do\+\_\+iterations@{do\+\_\+iterations}}
\index{do\+\_\+iterations@{do\+\_\+iterations}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{do\+\_\+iterations()}{do\_iterations()}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
void \hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::do\+\_\+iterations (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Vector$<$ double $>$ $>$ \&}]{sflxes\+\_\+proc,  }\item[{std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&}]{equ\+\_\+ptrs,  }\item[{std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$}]{ig\+\_\+ptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

This function will call mg\+\_\+iterations to perform MG iterations in fixed source problems. This function shall not be called in eigenvalue calculations.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000005}{Todo}]Implement N\+DA scheme in this function.\end{DoxyRefDesc}



\begin{DoxyParams}{Parameters}
{\em sflxes\+\_\+proc} & A vector of scalar fluxes for all groups. \\
\hline
{\em equ\+\_\+ptrs} & A vector of shared\+\_\+ptr\textquotesingle{}s of Equation\+Base objects. \\
\hline
{\em ig\+\_\+ptr} & A shared\+\_\+ptr of I\+G\+Base$<$dim$>$ object. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Definition at line 24 of file mg\+\_\+base.\+cc.

\mbox{\Hypertarget{class_m_g_base_a6ae523b6ee434588d85f8370413d0de9}\label{class_m_g_base_a6ae523b6ee434588d85f8370413d0de9}} 
\index{M\+G\+Base@{M\+G\+Base}!mg\+\_\+iterations@{mg\+\_\+iterations}}
\index{mg\+\_\+iterations@{mg\+\_\+iterations}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{mg\+\_\+iterations()}{mg\_iterations()}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
void \hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::mg\+\_\+iterations (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Vector$<$ double $>$ $>$ \&}]{sflxes\+\_\+proc,  }\item[{std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&}]{equ\+\_\+ptrs,  }\item[{std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$}]{ig\+\_\+ptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

A virtual function performing MG iterations. By default, it will call nonthermal\+\_\+solves for nonthermal MG calculations and thereafter the thermal\+\_\+iterations to iterate on the upscattering.

Overriding could be provided for this virtual function if nonthermal and thermal solves are not separated. An example is Jacobian Free Newton Krylov method.

There are two case of calling this function\+: one is to call this function inside eigen iterations and the other is in do\+\_\+iterations, which is designed for MG fixed source problem calculations.


\begin{DoxyParams}{Parameters}
{\em sflxes\+\_\+proc} & A vector of scalar fluxes for all groups living on current processor. \\
\hline
{\em equ\+\_\+ptrs} & A vector of shared\+\_\+ptr\textquotesingle{}s of Equation\+Base objects. \\
\hline
{\em ig\+\_\+ptr} & A shared\+\_\+ptr of I\+G\+Base object. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Definition at line 54 of file mg\+\_\+base.\+cc.

\mbox{\Hypertarget{class_m_g_base_a55ba9bef3616dd5eab9e3986f6e8e311}\label{class_m_g_base_a55ba9bef3616dd5eab9e3986f6e8e311}} 
\index{M\+G\+Base@{M\+G\+Base}!nonthermal\+\_\+solves@{nonthermal\+\_\+solves}}
\index{nonthermal\+\_\+solves@{nonthermal\+\_\+solves}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{nonthermal\+\_\+solves()}{nonthermal\_solves()}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
void \hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::nonthermal\+\_\+solves (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Vector$<$ double $>$ $>$ \&}]{sflxes\+\_\+proc,  }\item[{std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&}]{equ\+\_\+ptrs,  }\item[{std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$}]{ig\+\_\+ptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

This virtual function performs energy solves over nonthermal groups.

Usually, nonthermal groups have no upscattering. So this function is a group-\/by-\/ group one-\/pass solving until reaching the thermal group. It will not be called if algorithms like J\+F\+NK are called


\begin{DoxyParams}{Parameters}
{\em equ\+\_\+ptrs} & A vector of shared\+\_\+ptr\textquotesingle{}s of Equation\+Base objects. \\
\hline
{\em ig\+\_\+ptr} & A shared\+\_\+ptr of I\+G\+Base object. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Reimplemented in \hyperlink{class_gauss_seidel_a28fc4ef9150773f587f90951c704c994}{Gauss\+Seidel$<$ dim $>$}.



Definition at line 70 of file mg\+\_\+base.\+cc.

\mbox{\Hypertarget{class_m_g_base_a9d3c6ab6e58f0119badb30feedb2ac4d}\label{class_m_g_base_a9d3c6ab6e58f0119badb30feedb2ac4d}} 
\index{M\+G\+Base@{M\+G\+Base}!thermal\+\_\+iterations@{thermal\+\_\+iterations}}
\index{thermal\+\_\+iterations@{thermal\+\_\+iterations}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{thermal\+\_\+iterations()}{thermal\_iterations()}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
void \hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::thermal\+\_\+iterations (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Vector$<$ double $>$ $>$ \&}]{sflxes\+\_\+proc,  }\item[{std\+::vector$<$ std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_equation_base}{Equation\+Base}$<$ dim $>$ $>$ $>$ \&}]{equ\+\_\+ptrs,  }\item[{std\+\_\+cxx11\+::shared\+\_\+ptr$<$ \hyperlink{class_i_g_base}{I\+G\+Base}$<$ dim $>$ $>$}]{ig\+\_\+ptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

This virtual function performs iterative energy solves over thermal groups.

Thermal groups have upscattering for applications like L\+WR. So this function is to solve for thermal groups iteratively. It will not be called if algorithms like J\+F\+NK are called.


\begin{DoxyParams}{Parameters}
{\em equ\+\_\+ptrs} & A vector of shared\+\_\+ptr\textquotesingle{}s of Equation\+Base objects. \\
\hline
{\em ig\+\_\+ptr} & A shared\+\_\+ptr of I\+G\+Base object. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Reimplemented in \hyperlink{class_gauss_seidel_a8db6abbdc88413cbf502ac606b415733}{Gauss\+Seidel$<$ dim $>$}.



Definition at line 78 of file mg\+\_\+base.\+cc.



\subsection{Member Data Documentation}
\mbox{\Hypertarget{class_m_g_base_af50b1bdc92270c342524eacfc644170c}\label{class_m_g_base_af50b1bdc92270c342524eacfc644170c}} 
\index{M\+G\+Base@{M\+G\+Base}!err\+\_\+phi\+\_\+tol@{err\+\_\+phi\+\_\+tol}}
\index{err\+\_\+phi\+\_\+tol@{err\+\_\+phi\+\_\+tol}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{err\+\_\+phi\+\_\+tol}{err\_phi\_tol}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
const double \hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::err\+\_\+phi\+\_\+tol\hspace{0.3cm}{\ttfamily [protected]}}



Multigroup iteration tolerance for convergence check. 



Definition at line 104 of file mg\+\_\+base.\+h.

\mbox{\Hypertarget{class_m_g_base_a7df1f6ce51cf6eb033420be98b1f0019}\label{class_m_g_base_a7df1f6ce51cf6eb033420be98b1f0019}} 
\index{M\+G\+Base@{M\+G\+Base}!g\+\_\+thermal@{g\+\_\+thermal}}
\index{g\+\_\+thermal@{g\+\_\+thermal}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{g\+\_\+thermal}{g\_thermal}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
unsigned int \hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::g\+\_\+thermal\hspace{0.3cm}{\ttfamily [protected]}}



Starting group index where upscattering exists. 



Definition at line 103 of file mg\+\_\+base.\+h.

\mbox{\Hypertarget{class_m_g_base_ad8a9d4163bb31470fff74fe787c23788}\label{class_m_g_base_ad8a9d4163bb31470fff74fe787c23788}} 
\index{M\+G\+Base@{M\+G\+Base}!sflxes\+\_\+proc\+\_\+prev\+\_\+mg@{sflxes\+\_\+proc\+\_\+prev\+\_\+mg}}
\index{sflxes\+\_\+proc\+\_\+prev\+\_\+mg@{sflxes\+\_\+proc\+\_\+prev\+\_\+mg}!M\+G\+Base@{M\+G\+Base}}
\subsubsection{\texorpdfstring{sflxes\+\_\+proc\+\_\+prev\+\_\+mg}{sflxes\_proc\_prev\_mg}}
{\footnotesize\ttfamily template$<$int dim$>$ \\
std\+::vector$<$Vector$<$double$>$ $>$ \hyperlink{class_m_g_base}{M\+G\+Base}$<$ dim $>$\+::sflxes\+\_\+proc\+\_\+prev\+\_\+mg\hspace{0.3cm}{\ttfamily [protected]}}



A scalar flux vector recording the old sflxes\+\_\+proc. 



Definition at line 107 of file mg\+\_\+base.\+h.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/iteration/\hyperlink{mg__base_8h}{mg\+\_\+base.\+h}\item 
src/iteration/\hyperlink{mg__base_8cc}{mg\+\_\+base.\+cc}\end{DoxyCompactItemize}
