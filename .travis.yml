sudo: required

branches:
  only:
  - master
  - dev
  - restart

notifications:
  email: false

language: cpp

matrix:
 include:
 - env: DEALII=dealii/dealii:v8.4.2-gcc-mpi-fulldepsmanual-debugrelease
 - env: DEALII=dealii/dealii:v8.5.0-gcc-mpi-fulldepscandi-debugrelease

services:
 - docker

before_install:
 - sudo docker pull $DEALII

install:
 - sudo docker run $DEALII
 - id=$(sudo docker ps -l | tail -n1 | awk '{print $1}')
 - sudo docker cp ../BART $id:/home/dealii
 - id=$(sudo docker ps -l | tail -n1 | awk '{print $1}')
 - sudo docker commit $id dealii/dealii-bart

script:
 - sudo docker run dealii/dealii-bart /bin/sh -c "cmake BART/; make; ctest -j4"
